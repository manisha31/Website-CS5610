<%@ Page Language="C#" %>

<!DOCTYPE html>

<script runat="server">
 
    protected void btnInsert_Click(object sender, EventArgs e)
    {

        //     SqlDataSource1.Insert();
        txtName.Text = "";
        txtAddress.Text = "";
        txtSalary.Text = "";
    }
</script>

<html>
<head runat="server">
    <title>Experiment 6: SQL CRUD Operations</title>
    <script type="text/javascript">
        function validateFunction() {
            alert("Insert operation is disabled for security purposes.");
            var txtName = document.getElementById("txtName");
            var txtAddress = document.getElementById("txtAddress");
            var txtSalary = document.getElementById("txtSalary");

            if (txtName.value === "" || txtAddress.value === "" || txtSalary.value === "") {
                //          alert("Please enter all the details.");
                return false;
            }
            return true;
        }
    </script>
</head>
<body>
    <form id="form1" runat="server">
        <h1>SQL CRUD Operations</h1>
        <h3>Description:</h3>
        <p>
            Goal is to perform the CRUD operations i.e. Select, Update, Insert and Delete using SQL in a remote database.
          <br />
            I created a table "Employee" and added a few values to the schema. Now the data is displayed using GridView.
            I use <code>&lt;asp:SqlDataSource&gt;</code>  to perform the operations. This experiment will be used in my project
            to perform the basic SQL operations.
            <br />
            You could fill the following form and click "Insert" to enter values into the table, but for security purposes "insert" and "update"
            operations are disabled from this experiment.
        </p>

        <div>
            <table>
                <tr>
                    <td>Name :</td>
                    <td>
                        <asp:TextBox runat="server" ID="txtName" Enabled="false" />
                    </td>
                </tr>
                <tr>
                    <td>Address :</td>
                    <td>
                        <asp:TextBox runat="server" ID="txtAddress" Enabled="false" />
                    </td>
                </tr>
                <tr>
                    <td>Salary :</td>
                    <td>
                        <asp:TextBox runat="server" ID="txtSalary" Enabled="false" />
                    </td>
                </tr>
                <tr>
                    <td colspan="2">
                        <asp:Button Text="Insert" runat="server" ID="btnInsert" OnClick="btnInsert_Click"
                            OnClientClick="return validateFunction();" />

                    </td>

                </tr>
            </table>


            <asp:GridView ID="GridView1" runat="server" AutoGenerateColumns="false" DataKeyNames="Id" EmptyDataText="No Records Found" DataSourceID="SqlDataSource1" AutoGenerateDeleteButton="True">
                <Columns>
                    <asp:BoundField HeaderText="Name" DataField="Name" />
                    <asp:BoundField HeaderText="Address" DataField="Address" />
                    <asp:BoundField HeaderText="Salary" DataField="Salary" />

                </Columns>
            </asp:GridView>

            <asp:SqlDataSource ID="SqlDataSource1" runat="server" ConnectionString="<%$ ConnectionStrings:manishaCS %>"
                SelectCommand="SELECT * from ms31.[Employee]"
                UpdateCommand="UPDATE ms31.[Employee] SET [Name] = @Name, [Address] = @Address, [Salary] = @Salary
                               WHERE [Id] = @Id "
                DeleteCommand="DELETE from ms31.[Employee] where [Id] = @Id ">


                <UpdateParameters>
                    <asp:Parameter Name="Id" Type="Int32" />
                    <asp:Parameter Name="Name" Type="String" />
                    <asp:Parameter Name="Address" Type="String" />
                    <asp:Parameter Name="Salary" Type="String" />
                </UpdateParameters>
                <DeleteParameters>
                    <asp:Parameter Name="Id" Type="Int32" />
                </DeleteParameters>

            </asp:SqlDataSource>
        </div>
    </form>
    <hr />
    <h3>Source Files: </h3>
    <a href="../fileview/Default.aspx?~/Experiment/Experiment6.aspx" target="_blank">View Source</a><br />

    <hr />
    <h3>References:</h3>
    Prof. Rasala Examples
     <p>
         <a href="http://net4.ccs.neu.edu/home/ketkig/experiments/storyfiles/sqlCRUD.aspx" target="_blank">Ketki's Experiments</a>
     </p>

</body>
</html>
